<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åå¤å±‹ç­†è¨˜ 2026</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* ================== é¢¨æ ¼å®šç¾© ================== */
        :root {
            --paper-color: #fcfcfc;
            --ink-color: #1a1a1a;
            --accent-gold: #f59e0b; 
            --accent-miso: #9f1239; 
            --shadow-offset: 3px;
        }

        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: #f0f0f0;
            background-image: 
                linear-gradient(#e5e5e5 1px, transparent 1px),
                linear-gradient(90deg, #e5e5e5 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--ink-color);
            -webkit-tap-highlight-color: transparent;
        }

        .app-shell {
            max-width: 480px;
            margin: 0 auto;
            background: var(--paper-color);
            min-height: 100vh;
            border-left: 2px solid #1a1a1a;
            border-right: 2px solid #1a1a1a;
            position: relative;
            padding-bottom: 90px;
            display: flex;
            flex-direction: column;
        }

        /* å¡ç‰‡é¢¨æ ¼ */
        .sketch-card {
            background: white;
            border: 2px solid var(--ink-color);
            border-radius: 12px;
            box-shadow: var(--shadow-offset) var(--shadow-offset) 0px 0px var(--ink-color);
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .sketch-card:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0px 0px var(--ink-color);
        }

        .sketch-box {
            background: white;
            border: 2px solid var(--ink-color);
            border-radius: 12px;
            box-shadow: var(--shadow-offset) var(--shadow-offset) 0px 0px rgba(0,0,0,0.1);
        }

        /* äº¤é€šè³‡è¨Šæ¨™ç±¤ */
        .travel-tag {
            font-size: 0.65rem;
            background: #fff;
            border: 1px solid var(--ink-color);
            padding: 2px 8px;
            border-radius: 20px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            box-shadow: 1px 1px 0 rgba(0,0,0,0.1);
            color: #666;
            margin-left: 1rem;
            position: relative;
            z-index: 5;
        }

        /* å°è¦½åˆ— */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 476px;
            background: white;
            border-top: 2px solid var(--ink-color);
            display: flex;
            justify-content: space-around;
            padding: 12px 0 24px;
            z-index: 50;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            font-weight: 700;
            transition: all 0.2s;
        }
        .nav-item.active {
            color: var(--ink-color);
            transform: scale(1.1);
        }

        /* é é¢åˆ‡æ› */
        .page-content { display: none; animation: fadeIn 0.3s ease-out; }
        .page-content.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ™‚é–“è»¸ç·š */
        .sketch-timeline {
            position: absolute;
            left: 28px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: repeating-linear-gradient(to bottom, var(--ink-color), var(--ink-color) 4px, transparent 4px, transparent 10px);
            z-index: 0;
        }

        .sketch-input {
            border: 2px solid var(--ink-color);
            border-radius: 8px;
            outline: none;
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.05);
        }
        
        /* Map Styles */
        .map-container {
            position: relative;
            width: 100%;
            height: 400px;
            background-color: #fffbeb; 
            background-image: radial-gradient(#d6d3d1 1px, transparent 1px);
            background-size: 20px 20px;
            border: 2px solid var(--ink-color);
            border-radius: 12px;
            overflow: hidden;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        /* æ‰‹ç¹ªç·šæ¢å‹•ç•« */
        .path-line {
            stroke-dasharray: 12, 8; 
            stroke-dashoffset: 1000;
            animation: drawLine 4s forwards ease-in-out;
            stroke-linecap: round; 
            stroke-linejoin: round;
        }
        
        @keyframes drawLine {
            to { stroke-dashoffset: 0; }
        }
        
        .station-label {
            text-shadow: 2px 2px 0 #fffbeb, -1px -1px 0 #fffbeb;
        }

        /* Expense Styles */
        .expense-row {
            border-bottom: 1px dashed #ccc;
            padding: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .expense-row:last-child { border-bottom: none; }
        .delete-btn {
            color: #ef4444;
            margin-left: 10px;
            cursor: pointer;
            opacity: 0.6;
        }
        .delete-btn:hover { opacity: 1; }

        /* Stickman Animation */
        .stickman-arm {
            transform-origin: 25px 20px; /* Pivot point at shoulder */
            animation: waveArm 0.6s ease-in-out infinite alternate;
        }
        @keyframes waveArm {
            from { transform: rotate(-10deg); }
            to { transform: rotate(25deg); }
        }

        /* éš±è—æ»¾å‹•æ¢ */
        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
</head>
<body>

    <!-- SHARED SVG DEFS (Hidden) -->
    <svg width="0" height="0" style="position:absolute">
        <defs>
            <marker id="arrow-pink" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L6,3 L0,6" fill="none" stroke="#ec4899" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </marker>
            <marker id="arrow-green" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L6,3 L0,6" fill="none" stroke="#4ade80" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </marker>
            <marker id="arrow-blue" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L6,3 L0,6" fill="none" stroke="#38bdf8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </marker>
            <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
                <feGaussianBlur in="SourceAlpha" stdDeviation="1"/>
                <feOffset dx="1" dy="1" result="offsetblur"/>
                <feComponentTransfer><feFuncA type="linear" slope="0.3"/></feComponentTransfer>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
        </defs>
    </svg>

    <div class="app-shell">
        
        <!-- ================= HOME PAGE ================= -->
        <div id="page-home" class="page-content active p-6">
            <!-- Header -->
            <div class="flex justify-between items-start mb-6 mt-4 border-b-2 border-dashed border-gray-300 pb-4">
                <div>
                    <h1 class="text-3xl font-black tracking-tight flex items-center gap-2">
                        <span>åå¤å±‹</span>
                        <span class="text-xs bg-black text-white px-2 py-1 rounded rotate-3 inline-block">GO!</span>
                    </h1>
                    <p class="text-sm font-bold mt-1 pl-1">2026.03.02 - 03.06</p>
                </div>
                <div class="w-12 h-12 border-2 border-black rounded-full flex items-center justify-center bg-yellow-400 shadow-[2px_2px_0_0_#000]">
                    <i class="fas fa-child-reaching text-xl"></i>
                </div>
            </div>

            <!-- Weather -->
            <div class="mb-8">
                <h2 class="font-bold text-lg mb-3 flex items-center gap-2"><i class="fas fa-cloud-sun"></i> <span>å¤©æ°£é å ±</span></h2>
                <div class="flex overflow-x-auto space-x-3 pb-2">
                    <div class="flex-shrink-0 sketch-box w-20 p-2 flex flex-col items-center bg-blue-50">
                        <span class="text-xs font-black">Mon</span><span class="text-[10px] mb-1">3/02</span>
                        <i class="fas fa-plane-arrival text-xl mb-1"></i><span class="font-bold">14Â°</span>
                    </div>
                    <div class="flex-shrink-0 sketch-box w-20 p-2 flex flex-col items-center bg-yellow-50 transform -rotate-2 border-yellow-400">
                        <span class="text-xs font-black text-red-600">Tue</span><span class="text-[10px] mb-1">3/03</span>
                        <i class="fas fa-sun text-xl mb-1 text-orange-500"></i><span class="font-bold">16Â°</span>
                    </div>
                    <div class="flex-shrink-0 sketch-box w-20 p-2 flex flex-col items-center bg-white">
                        <span class="text-xs font-black">Wed</span><span class="text-[10px] mb-1">3/04</span>
                        <i class="fas fa-cloud text-xl mb-1 text-gray-400"></i><span class="font-bold">17Â°</span>
                    </div>
                    <div class="flex-shrink-0 sketch-box w-20 p-2 flex flex-col items-center bg-white">
                        <span class="text-xs font-black">Thu</span><span class="text-[10px] mb-1">3/05</span>
                        <i class="fas fa-cloud-sun text-xl mb-1 text-gray-500"></i><span class="font-bold">15Â°</span>
                    </div>
                    <div class="flex-shrink-0 sketch-box w-20 p-2 flex flex-col items-center bg-blue-50">
                        <span class="text-xs font-black">Fri</span><span class="text-[10px] mb-1">3/06</span>
                        <i class="fas fa-plane-departure text-xl mb-1"></i><span class="font-bold">15Â°</span>
                    </div>
                </div>
            </div>

            <!-- Currency -->
            <div class="sketch-box p-4 mb-8 bg-white relative">
                <div class="absolute -top-3 left-4 bg-black text-white text-xs px-2 py-1 font-bold transform -rotate-2">RATE: 0.215</div>
                <div class="flex items-center gap-2 mt-2">
                    <div class="flex-1"><label class="block text-xs font-bold mb-1 ml-1">ğŸ‡¯ğŸ‡µ JPY</label><input type="number" id="input-jpy" class="sketch-input w-full p-2 text-lg font-bold bg-gray-50" placeholder="Â¥"></div>
                    <i class="fas fa-exchange-alt text-gray-400 mt-5"></i>
                    <div class="flex-1"><label class="block text-xs font-bold mb-1 ml-1">ğŸ‡¹ğŸ‡¼ TWD</label><input type="number" id="input-twd" class="sketch-input w-full p-2 text-lg font-bold bg-gray-50" placeholder="$"></div>
                </div>
                <div id="exchange-rate-display" class="text-right text-[10px] text-gray-400 mt-2 font-mono">1 TWD â‰ˆ 4.65 JPY</div>
            </div>

            <!-- Itinerary Menu -->
            <h2 class="font-bold text-lg mb-4 flex items-center gap-2"><i class="fas fa-list-ul"></i><span>è¡Œç¨‹ç¸½è¦½</span></h2>
            <div class="space-y-4">
                <!-- Arrival -->
                <div class="sketch-box p-3 bg-gray-100 border-dashed">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 flex items-center justify-center text-xl"><i class="fas fa-plane-arrival"></i></div>
                        <div>
                            <h3 class="font-bold">3/02 (ä¸€) æŠµé”</h3>
                            <p class="text-xs text-gray-500">NGO 20:25 æŠµé” â€¢ å®¿ Trip & Sleep</p>
                        </div>
                    </div>
                </div>

                <!-- Day 1 -->
                <div onclick="switchPage('page-day1')" class="sketch-card p-4 flex items-center gap-4 cursor-pointer bg-orange-50">
                    <div class="w-10 h-10 flex flex-col items-center justify-center border-2 border-black rounded-full bg-white"><span class="font-black text-sm">D1</span></div>
                    <div class="flex-1">
                        <h3 class="font-bold text-lg">å¸‚å€ç¾é£Ÿå·¡ç¦®</h3>
                        <p class="text-xs font-bold text-gray-500 mt-1">3/03 Tue â€¢ ç‚¸è¦/å¤§é ˆ/é°»é­šé£¯</p>
                    </div>
                    <i class="fas fa-arrow-right"></i>
                </div>

                <!-- Day 2 -->
                <div onclick="switchPage('page-day2')" class="sketch-card p-4 flex items-center gap-4 cursor-pointer bg-pink-50">
                    <div class="w-10 h-10 flex flex-col items-center justify-center border-2 border-black rounded-full bg-white"><span class="font-black text-sm">D2</span></div>
                    <div class="flex-1">
                        <h3 class="font-bold text-lg">çŠ¬å±±åŸå¤éƒ½éŠ</h3>
                        <p class="text-xs font-bold text-gray-500 mt-1">3/04 Wed â€¢ åœ‹å¯¶åŸ/å’–å•¡ååº—</p>
                    </div>
                    <i class="fas fa-arrow-right"></i>
                </div>

                <!-- Day 3 -->
                <div onclick="switchPage('page-day3')" class="sketch-card p-4 flex items-center gap-4 cursor-pointer bg-yellow-50">
                    <div class="w-10 h-10 flex flex-col items-center justify-center border-2 border-black rounded-full bg-white"><span class="font-black text-sm">D3</span></div>
                    <div class="flex-1">
                        <h3 class="font-bold text-lg">ååŸèˆ‡è³¼ç‰©</h3>
                        <p class="text-xs font-bold text-gray-500 mt-1">3/05 Thu â€¢ é‡‘é¯±/æ¦®å•†åœˆ</p>
                    </div>
                    <i class="fas fa-arrow-right"></i>
                </div>

                 <!-- Departure -->
                 <div class="sketch-box p-3 bg-gray-100 border-dashed">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 flex items-center justify-center text-xl"><i class="fas fa-plane-departure"></i></div>
                        <div>
                            <h3 class="font-bold">3/06 (äº”) è¿”ç¨‹</h3>
                            <p class="text-xs text-gray-500">NGO 13:15 èµ·é£›</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ================= DAY 1 PAGE ================= -->
        <div id="page-day1" class="page-content min-h-full">
            <div class="sticky top-0 bg-white/95 border-b-2 border-black p-4 z-40 flex items-center justify-between">
                <div><h2 class="font-black text-2xl">Day 01</h2><p class="text-xs font-bold bg-orange-100 inline-block px-1">3/03 Tue â€¢ å¸‚å€</p></div>
                <div class="text-3xl">ğŸ¤</div>
            </div>
            
            <div class="p-6 relative pb-20">
                <div class="sketch-timeline"></div>
                <!-- Timeline Items -->
                <!-- 08:00 Start -->
                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-person-walking"></i></div>
                        <span class="text-xs font-black bg-white px-1">08:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-box p-3 bg-white"><h3 class="font-bold">Trip & Sleep Hostel</h3><p class="text-xs text-gray-500">å‡ºç™¼ï¼</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-train"></i> åœ°éµååŸç·š | 10åˆ† | Â¥210</div></div>

                <!-- 08:15 Breakfast -->
                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-orange-100 border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-mug-hot"></i></div>
                        <span class="text-xs font-black bg-white px-1">08:15</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4 relative overflow-hidden"><h3 class="font-bold text-lg">Konparu (æ¦®)</h3><p class="text-sm">ğŸ¤ ç‚¸è¦ä¸‰æ˜æ²»</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-person-walking"></i> æ­¥è¡Œæˆ–åœ°éµ | 15åˆ† | Â¥210</div></div>

                <!-- 08:45 Market -->
                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-fish"></i></div>
                        <span class="text-xs font-black bg-white px-1">08:45</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-box p-3 bg-blue-50 border-dashed"><h3 class="font-bold">æŸ³æ©‹ä¸­å¤®å¸‚å ´</h3><p class="text-xs mt-1">ç”Ÿé­šç‰‡æ—©é¤</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-person-walking"></i> æ­¥è¡Œ | 10åˆ† | Â¥0</div></div>

                <!-- 12:00 Lunch -->
                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-yellow-100 border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-utensils"></i></div>
                        <span class="text-xs font-black bg-white px-1">12:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4"><h3 class="font-bold">é³¥é–‹ç·æœ¬å®¶</h3><p class="font-black text-yellow-600 mt-1">ğŸ¥š é‡‘è³è¦ªå­ä¸¼</p><p class="text-xs text-gray-500">Lucent Toweråº—</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-train"></i> åœ°éµæ±å±±ç·š | 15åˆ† | Â¥240</div></div>

                <!-- 13:30 Osu -->
                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-red-100 border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-bag-shopping"></i></div>
                        <span class="text-xs font-black bg-white px-1">13:30</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4 bg-red-50"><h3 class="font-bold text-lg">å¤§é ˆå•†åº—è¡—</h3><p class="text-xs mt-1">Kannon Coffee / æ„›éº—çµ² / å¤è‘—</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-person-walking"></i> æ­¥è¡Œæˆ–åœ°éµ | 15åˆ† | Â¥210</div></div>

                <!-- 17:00 Dinner -->
                <div class="relative flex mb-8">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-black text-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-bowl-rice"></i></div>
                        <span class="text-xs font-black bg-white px-1">17:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4 bg-white border-4 border-double"><h3 class="font-bold text-xl">ç†±ç”°è“¬èŠè»’</h3><p class="text-xs font-bold text-gray-400">æ¾é˜ªå±‹åº—</p><div class="mt-2 bg-black text-white p-2 rounded text-center transform -rotate-1"><span class="text-lg">ğŸ± é°»é­šé£¯ä¸‰åƒ</span></div></div></div>
                </div>

                <!-- DAY 1 MAP (EMBEDDED) -->
                <div class="map-container relative">
                    <h4 class="absolute top-2 left-3 font-bold text-xs bg-white px-2 py-1 border border-black rounded z-10">Day 1 Route</h4>
                    <svg viewBox="0 0 350 400" class="w-full h-full">
                        <!-- Infrastructure -->
                        <path d="M 120 0 Q 110 200 130 400" fill="none" stroke="#e0f2fe" stroke-width="20" stroke-linecap="round" />
                        <line x1="0" y1="200" x2="350" y2="200" stroke="#e5e5e5" stroke-width="12" /> <!-- Wakamiya -->
                        <line x1="230" y1="0" x2="230" y2="400" stroke="#e5e5e5" stroke-width="12" /> <!-- Hisaya -->
                        <path d="M 60 0 L 60 400" fill="none" stroke="#777" stroke-width="2" stroke-dasharray="4,4" />

                        <!-- Day 1 Route (Blue) -->
                        <!-- Hostel(210,210) -> Sakae(240,80) -> Station(60,80) -> Osu(120,200) -> Atsuta(180,350) -> Hostel -->
                        <path d="M 210 210 Q 250 150 240 80" fill="none" stroke="#38bdf8" stroke-width="4" stroke-dasharray="10,5" stroke-linecap="round" class="path-line" marker-end="url(#arrow-blue)" />
                        <path d="M 240 80 Q 150 50 60 80" fill="none" stroke="#38bdf8" stroke-width="4" stroke-dasharray="10,5" stroke-linecap="round" class="path-line" marker-end="url(#arrow-blue)" />
                        <path d="M 60 80 Q 80 150 120 200" fill="none" stroke="#38bdf8" stroke-width="4" stroke-dasharray="10,5" stroke-linecap="round" class="path-line" marker-end="url(#arrow-blue)" />
                        <path d="M 120 200 Q 150 300 180 350" fill="none" stroke="#38bdf8" stroke-width="4" stroke-dasharray="10,5" stroke-linecap="round" class="path-line" marker-end="url(#arrow-blue)" />
                        <path d="M 180 350 Q 220 300 210 210" fill="none" stroke="#38bdf8" stroke-width="4" stroke-dasharray="10,5" stroke-linecap="round" class="path-line" marker-end="url(#arrow-blue)" />

                        <!-- Stations -->
                        <text x="40" y="70" font-size="28" filter="url(#dropShadow)">ğŸš‰</text>
                        <text x="60" y="95" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">åå¤å±‹ç«™</text>
                        
                        <text x="220" y="70" font-size="28" filter="url(#dropShadow)">ğŸš‰</text>
                        <text x="240" y="95" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">æ¦®ç«™</text>

                        <text x="160" y="190" font-size="28" filter="url(#dropShadow)">ğŸš‰</text>
                        <text x="180" y="215" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">ä¸Šå‰æ´¥ç«™</text>

                        <!-- Base -->
                        <path d="M 190 200 Q 205 205 210 215" fill="none" stroke="black" stroke-width="1.5" stroke-dasharray="3,2" />
                        <g transform="translate(210, 210)">
                            <path d="M 0 15 L 15 0 L 30 15" fill="none" stroke="#1a1a1a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M 5 15 L 5 30 L 25 30 L 25 15" fill="none" stroke="#1a1a1a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M 12 30 L 12 20 L 18 20 L 18 30" fill="none" stroke="#1a1a1a" stroke-width="2" />
                            <text x="15" y="45" text-anchor="middle" font-size="9" font-weight="bold" fill="#22c55e" class="station-label">ä½å®¿</text>
                        </g>

                        <!-- Points -->
                        <circle cx="240" cy="80" r="8" fill="#38bdf8" stroke="white" stroke-width="2" transform="translate(0,20)"/> <text x="240" y="104" text-anchor="middle" font-size="10" font-weight="bold" fill="white">1</text>
                        <circle cx="60" cy="80" r="8" fill="#38bdf8" stroke="white" stroke-width="2" transform="translate(0,-15)"/> <text x="60" y="69" text-anchor="middle" font-size="10" font-weight="bold" fill="white">2</text>
                        <circle cx="120" cy="200" r="8" fill="#38bdf8" stroke="white" stroke-width="2"/> <text x="120" y="204" text-anchor="middle" font-size="10" font-weight="bold" fill="white">3</text>
                        <circle cx="180" cy="350" r="8" fill="#38bdf8" stroke="white" stroke-width="2"/> <text x="180" y="354" text-anchor="middle" font-size="10" font-weight="bold" fill="white">4</text>

                        <!-- Labels -->
                        <text x="250" y="70" font-size="9" font-weight="bold" fill="#38bdf8" class="station-label">ç‚¸è¦ä¸‰æ˜æ²»</text>
                        <text x="115" y="180" text-anchor="middle" font-size="20" filter="url(#dropShadow)">â›©ï¸</text>
                        <text x="95" y="180" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">å¤§é ˆ</text>
                        <text x="160" y="350" font-size="24" filter="url(#dropShadow)">ğŸ±</text>
                        <text x="210" y="345" font-size="10" font-weight="bold" class="station-label">ç†±ç”°ç¥å®®</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ================= DAY 2 PAGE ================= -->
        <div id="page-day2" class="page-content min-h-full">
            <div class="sticky top-0 bg-white/95 border-b-2 border-black p-4 z-40 flex items-center justify-between">
                <div><h2 class="font-black text-2xl">Day 02</h2><p class="text-xs font-bold bg-pink-100 inline-block px-1">3/04 Wed â€¢ çŠ¬å±±</p></div>
                <div class="text-3xl">ğŸŒ¸</div>
            </div>

            <div class="p-6 relative pb-20">
                <div class="sketch-timeline"></div>
                <!-- Timeline Items -->
                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-bread-slice"></i></div>
                        <span class="text-xs font-black bg-white px-1">08:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-box p-3 bg-white"><h3 class="font-bold">Bucyo Coffee</h3><p class="text-sm">ğŸ å°å€‰ç´…è±†åå¸</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-person-walking"></i> å¾€åå¤å±‹ç«™ | 10åˆ†</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-red-500 text-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-train"></i></div>
                        <span class="text-xs font-black bg-white px-1">09:15</span>
                    </div>
                    <div class="flex-1 pl-2 flex items-center"><div class="bg-white border-2 border-black px-4 py-2 rounded-full text-xs font-bold transform -rotate-2">åéµçŠ¬å±±ç·š ğŸšƒ</div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-train"></i> åéµæ€¥è¡Œ | 30åˆ† | Â¥570</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-pink-100 border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-chess-rook"></i></div>
                        <span class="text-xs font-black bg-white px-1">10:30</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-0 overflow-hidden"><div class="bg-sky-100 h-24 flex items-center justify-center text-5xl relative">ğŸ¯</div><div class="p-3"><h3 class="font-bold text-lg">åœ‹å¯¶ çŠ¬å±±åŸ</h3><p class="text-xs text-gray-500">æ—¥æœ¬æœ€å¤è€å¤©å®ˆé–£</p></div></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-person-walking"></i> æ­¥è¡Œ | 10åˆ†</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-utensils"></i></div>
                        <span class="text-xs font-black bg-white px-1">12:30</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-box p-3 bg-white"><h3 class="font-bold">Sakura Chaya</h3><p class="text-sm font-bold mt-1">ğŸ¡ ç”°æ¨‚çƒ¤è±†è…ä¸²</p></div></div>
                </div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-camera"></i></div>
                        <span class="text-xs font-black bg-white px-1">14:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4 bg-pink-50"><h3 class="font-bold mb-2">åŸä¸‹ç”ºæ•£ç­–</h3><p class="text-xs">æˆ€æ„›ç¥ç¤¾ â¤ï¸ / é£›é©’ç‰›å£½å¸ ğŸ£</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag bg-yellow-50 border-yellow-600 text-yellow-800"><i class="fas fa-exchange-alt"></i> åéµ+åœ°éµé¶´èˆç·š | 75åˆ† | Â¥840</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-amber-800 text-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-coffee"></i></div>
                        <span class="text-xs font-black bg-white px-1">16:30</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-box p-3 bg-amber-50 border-dashed"><h3 class="font-bold">GOLPIE COFFEE</h3><p class="text-xs text-amber-900">ğŸ“ å·åå±± (æ˜­å’Œå€)</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-train"></i> åœ°éµé¶´èˆç·š | 20åˆ† | Â¥240</div></div>

                <div class="relative flex mb-8">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-black text-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-drumstick-bite"></i></div>
                        <span class="text-xs font-black bg-white px-1">19:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4 bg-gray-800 text-white"><div class="flex justify-between items-start"><h3 class="font-bold text-yellow-400 text-lg">ä¸–ç•Œçš„å±±å°‡</h3><i class="fas fa-beer text-xl"></i></div><div class="mt-2 flex items-center gap-2 text-sm"><span>ğŸ— å¤¢å¹»æ‰‹ç¾½å…ˆ</span></div></div></div>
                </div>

                <!-- DAY 2 MAP (EMBEDDED) -->
                <div class="map-container relative">
                    <h4 class="absolute top-2 left-3 font-bold text-xs bg-white px-2 py-1 border border-black rounded z-10">Day 2 Route</h4>
                    <svg viewBox="0 0 350 400" class="w-full h-full">
                        <path d="M 120 0 Q 110 200 130 400" fill="none" stroke="#e0f2fe" stroke-width="20" stroke-linecap="round" />
                        <path d="M 60 0 L 60 400" fill="none" stroke="#777" stroke-width="2" stroke-dasharray="4,4" />

                        <!-- Route: Hostel(210,350) -> Station(60,250) -> Inuyama(180,50) -> Golpie(280,300) -> Hostel -->
                        <path d="M 210 350 Q 160 320 60 250" fill="none" stroke="#ec4899" stroke-width="3" stroke-dasharray="8,5" class="path-line" marker-end="url(#arrow-pink)" />
                        <path d="M 60 250 Q 60 150 180 50" fill="none" stroke="#ec4899" stroke-width="3" stroke-dasharray="8,5" class="path-line" marker-end="url(#arrow-pink)" />
                        <path d="M 180 50 Q 300 200 280 300" fill="none" stroke="#ec4899" stroke-width="3" stroke-dasharray="8,5" class="path-line" marker-end="url(#arrow-pink)" />
                        <path d="M 280 300 Q 250 340 210 350" fill="none" stroke="#ec4899" stroke-width="3" stroke-dasharray="8,5" class="path-line" marker-end="url(#arrow-pink)" />

                        <!-- Inuyama -->
                        <text x="160" y="50" font-size="24" filter="url(#dropShadow)">ğŸ¯</text>
                        <text x="205" y="50" font-size="12" font-weight="bold" class="station-label">çŠ¬å±±åŸ</text>
                        <text x="205" y="64" font-size="9" fill="#666" class="station-label">åŸä¸‹ç”º</text>

                        <!-- Station -->
                        <text x="40" y="230" font-size="28" filter="url(#dropShadow)">ğŸš‰</text>
                        <text x="60" y="255" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">åå¤å±‹ç«™</text>

                        <!-- Golpie -->
                        <text x="270" y="280" font-size="18" filter="url(#dropShadow)">â˜•</text>
                        <text x="300" y="300" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">å·åå±±</text>
                        <text x="300" y="312" text-anchor="middle" font-size="9" fill="#666" class="station-label">Golpie</text>

                        <!-- Base -->
                        <text x="160" y="330" font-size="28" filter="url(#dropShadow)">ğŸš‰</text>
                        <text x="180" y="355" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">ä¸Šå‰æ´¥ç«™</text>
                        <path d="M 190 340 Q 205 345 210 355" fill="none" stroke="black" stroke-width="1.5" stroke-dasharray="3,2" />
                        <g transform="translate(210, 350)">
                            <path d="M 0 15 L 15 0 L 30 15" fill="none" stroke="#1a1a1a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M 5 15 L 5 30 L 25 30 L 25 15" fill="none" stroke="#1a1a1a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M 12 30 L 12 20 L 18 20 L 18 30" fill="none" stroke="#1a1a1a" stroke-width="2" />
                            <text x="15" y="45" text-anchor="middle" font-size="9" font-weight="bold" fill="#22c55e" class="station-label">ä½å®¿</text>
                        </g>
                        
                        <!-- Decor -->
                        <text x="50" y="380" font-size="18">ğŸŒ²</text>
                        <text x="280" y="100" font-size="18">ğŸŒ²</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ================= DAY 3 PAGE ================= -->
        <div id="page-day3" class="page-content min-h-full">
            <div class="sticky top-0 bg-white/95 border-b-2 border-black p-4 z-40 flex items-center justify-between">
                <div><h2 class="font-black text-2xl">Day 03</h2><p class="text-xs font-bold bg-yellow-100 inline-block px-1">3/05 Thu â€¢ ååŸ</p></div>
                <div class="text-3xl">ğŸ‹</div>
            </div>

            <div class="p-6 relative pb-20">
                <div class="sketch-timeline"></div>

                <!-- Timeline Items -->
                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-gray-700 text-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-coffee"></i></div>
                        <span class="text-xs font-black bg-white px-1">08:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-box p-3 bg-white"><h3 class="font-bold">Karasu (ã‚«ãƒ©ã‚¹)</h3><p class="text-sm mt-1 font-bold">â˜•ï¸ é»‘å’–å•¡ +åå¸æ°´ç…®è›‹</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-train"></i> åœ°éµæ±å±±ç·š | 10åˆ† | Â¥210</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-yellow-400 border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-landmark"></i></div>
                        <span class="text-xs font-black bg-white px-1">09:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4 bg-black text-white text-center"><div class="flex justify-center gap-4 text-3xl mb-2"><span>ğŸ‹</span><span>ğŸ¯</span><span>ğŸ‹</span></div><h3 class="font-bold text-xl text-yellow-400">åå¤å±‹åŸ</h3></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-bus"></i> è§€å…‰å·´å£« | 20åˆ† | Â¥210</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-green-100 border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-tree"></i></div>
                        <span class="text-xs font-black bg-white px-1">11:30</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-box p-3 bg-green-50 border-dashed"><h3 class="font-bold text-green-900">å¾·å·åœ’</h3><p class="text-xs text-green-800">æ—¥å¼åº­åœ’</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-bus"></i> å·´å£«/åœ°éµ | 30åˆ† | Â¥240</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-utensils"></i></div>
                        <span class="text-xs font-black bg-white px-1">13:30</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4"><h3 class="font-bold">Yellow (å‰‡æ­¦æ–°ç”º)</h3><p class="text-sm font-bold mt-1">ğŸ› æ¿ƒåšæ­å§†è›‹åŒ…é£¯</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-train"></i> åœ°éµæ±å±±ç·š | 15åˆ† | Â¥210</div></div>

                <div class="relative flex">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-purple-100 border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-tags"></i></div>
                        <span class="text-xs font-black bg-white px-1">15:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4 bg-purple-50"><h3 class="font-bold text-purple-900">æ¦® (Sakae) å•†åœˆ</h3><p class="text-xs font-bold mt-1">LACHIC | ä¸­æ—¥å¤§æ¨“</p></div></div>
                </div>
                <div class="my-4 pl-14"><div class="travel-tag"><i class="fas fa-train"></i> åœ°éµ | 10åˆ† | Â¥210</div></div>

                <div class="relative flex mb-8">
                    <div class="w-14 flex flex-col items-center z-10">
                        <div class="bg-orange-500 text-white border-2 border-black w-8 h-8 rounded-full flex items-center justify-center mb-1"><i class="fas fa-shrimp"></i></div>
                        <span class="text-xs font-black bg-white px-1">18:00</span>
                    </div>
                    <div class="flex-1 pl-2"><div class="sketch-card p-4"><h3 class="font-bold">æµ·è€ã©ã¦é£Ÿå ‚</h3><span class="text-[10px] font-bold block mt-1 bg-orange-100 w-fit px-1">35cm ç‰¹å¤§ç‚¸è¦</span></div></div>
                </div>

                <!-- DAY 3 MAP (EMBEDDED) -->
                <div class="map-container relative">
                    <h4 class="absolute top-2 left-3 font-bold text-xs bg-white px-2 py-1 border border-black rounded z-10">Day 3 Route</h4>
                    <svg viewBox="0 0 350 400" class="w-full h-full">
                        <path d="M 120 0 Q 110 200 130 400" fill="none" stroke="#e0f2fe" stroke-width="20" stroke-linecap="round" />
                        <line x1="0" y1="200" x2="350" y2="200" stroke="#e5e5e5" stroke-width="12" />
                        <line x1="230" y1="0" x2="230" y2="400" stroke="#e5e5e5" stroke-width="12" />

                        <!-- Route: Hostel(210,350) -> Castle(120,100) -> Tokugawa(280,120) -> Sakae(230,220) -> Hostel -->
                        <path d="M 210 350 Q 200 250 120 100" fill="none" stroke="#4ade80" stroke-width="4" stroke-dasharray="6,8" stroke-linecap="round" class="path-line" marker-end="url(#arrow-green)" />
                        <path d="M 120 100 Q 200 80 280 120" fill="none" stroke="#4ade80" stroke-width="4" stroke-dasharray="6,8" stroke-linecap="round" class="path-line" marker-end="url(#arrow-green)" /> 
                        <path d="M 280 120 Q 280 180 230 220" fill="none" stroke="#4ade80" stroke-width="4" stroke-dasharray="6,8" stroke-linecap="round" class="path-line" marker-end="url(#arrow-green)" /> 
                        <path d="M 230 220 Q 240 300 210 350" fill="none" stroke="#4ade80" stroke-width="4" stroke-dasharray="6,8" stroke-linecap="round" class="path-line" marker-end="url(#arrow-green)" /> 

                        <!-- Castle -->
                        <text x="120" y="90" font-size="24" filter="url(#dropShadow)">ğŸ‹</text>
                        <text x="110" y="80" font-size="10" font-weight="bold" class="station-label">åå¤å±‹åŸ</text>
                        <circle cx="120" cy="100" r="8" fill="#4ade80" stroke="white" stroke-width="2"/> <text x="120" y="104" text-anchor="middle" font-size="10" font-weight="bold" fill="white">1</text>

                        <!-- Tokugawa -->
                        <text x="280" y="110" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">å¾·å·åœ’</text>
                        <circle cx="280" cy="120" r="8" fill="#4ade80" stroke="white" stroke-width="2"/> <text x="280" y="124" text-anchor="middle" font-size="10" font-weight="bold" fill="white">2</text>

                        <!-- Sakae -->
                        <text x="210" y="200" font-size="28" filter="url(#dropShadow)">ğŸš‰</text>
                        <text x="230" y="225" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">æ¦®ç«™</text>
                        <circle cx="230" cy="220" r="8" fill="#4ade80" stroke="white" stroke-width="2" transform="translate(15,-10)"/> <text x="245" y="214" text-anchor="middle" font-size="10" font-weight="bold" fill="white">3</text>

                        <!-- Base -->
                        <text x="160" y="330" font-size="28" filter="url(#dropShadow)">ğŸš‰</text>
                        <text x="180" y="355" text-anchor="middle" font-size="10" font-weight="bold" class="station-label">ä¸Šå‰æ´¥ç«™</text>
                        <path d="M 190 340 Q 205 345 210 355" fill="none" stroke="black" stroke-width="1.5" stroke-dasharray="3,2" />
                        <g transform="translate(210, 350)">
                            <path d="M 0 15 L 15 0 L 30 15" fill="none" stroke="#1a1a1a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M 5 15 L 5 30 L 25 30 L 25 15" fill="none" stroke="#1a1a1a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M 12 30 L 12 20 L 18 20 L 18 30" fill="none" stroke="#1a1a1a" stroke-width="2" />
                            <text x="15" y="45" text-anchor="middle" font-size="9" font-weight="bold" fill="#22c55e" class="station-label">ä½å®¿</text>
                        </g>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ================= EXPENSE PAGE ================= -->
        <div id="page-expenses" class="page-content p-6 min-h-full">
            <div class="sticky top-0 bg-white/95 border-b-2 border-black p-4 z-40 flex items-center justify-between mb-4">
                <div>
                    <h2 class="font-black text-2xl">è¨˜å¸³æœ¬</h2>
                    <p class="text-xs font-bold text-gray-500">Expense Tracker</p>
                </div>
                <div class="text-2xl text-yellow-500"><i class="fas fa-coins"></i></div>
            </div>

            <div class="sketch-box p-3 bg-yellow-50 border-dashed mb-6 text-center text-sm font-bold text-gray-600 flex items-center justify-center gap-2">
                <span>ğŸ’¡ è«‹ç”¨æ—¥å¹£åƒ¹æ ¼è¼¸å…¥</span>
                <svg width="24" height="24" viewBox="0 0 50 50" overflow="visible">
                    <!-- Head -->
                    <circle cx="25" cy="10" r="5" fill="none" stroke="#4b5563" stroke-width="2"/>
                    <!-- Body -->
                    <line x1="25" y1="15" x2="25" y2="35" stroke="#4b5563" stroke-width="2"/>
                    <!-- Legs -->
                    <line x1="25" y1="35" x2="18" y2="45" stroke="#4b5563" stroke-width="2"/>
                    <line x1="25" y1="35" x2="32" y2="45" stroke="#4b5563" stroke-width="2"/>
                    <!-- Static Arm -->
                    <line x1="25" y1="20" x2="15" y2="25" stroke="#4b5563" stroke-width="2"/>
                    <!-- Waving Arm Group -->
                    <g class="stickman-arm">
                        <!-- Arm -->
                        <line x1="25" y1="20" x2="35" y2="10" stroke="#4b5563" stroke-width="2"/>
                        <!-- Bill -->
                        <rect x="32" y="2" width="14" height="8" fill="#86efac" stroke="#4b5563" stroke-width="1" transform="rotate(-15 32 10)"/>
                        <text x="39" y="9" font-size="6" font-weight="bold" fill="#065f46" text-anchor="middle" transform="rotate(-15 32 10)">Â¥</text>
                    </g>
                </svg>
            </div>

            <!-- Categories Container -->
            <div id="expenses-container" class="space-y-6 pb-20">
                <!-- Will be populated by JS -->
            </div>

            <!-- Total Sticky Footer -->
            <div class="fixed bottom-[70px] left-0 right-0 bg-gray-900 text-white p-4 mx-4 rounded-xl shadow-2xl z-50 border-2 border-white max-w-[448px] md:mx-auto">
                <div class="flex justify-between items-center">
                    <div>
                        <div class="text-[10px] text-gray-400 uppercase tracking-widest">Total Expenses</div>
                        <div class="text-2xl font-black text-yellow-400">Â¥ <span id="total-jpy">0</span></div>
                    </div>
                    <div class="text-right">
                        <div class="text-[10px] text-gray-400">Approx. TWD</div>
                        <div class="text-lg font-bold">NT$ <span id="total-twd">0</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button onclick="switchPage('page-home')" id="nav-home" class="nav-item active"><i class="fas fa-home text-xl mb-1"></i><span class="text-[10px]">Home</span></button>
            <button onclick="switchPage('page-day1')" id="nav-day1" class="nav-item"><i class="fas fa-child text-xl mb-1"></i><span class="text-[10px] text-center leading-none">D1<br>3/03</span></button>
            <button onclick="switchPage('page-day2')" id="nav-day2" class="nav-item"><i class="fas fa-child-reaching text-xl mb-1"></i><span class="text-[10px] text-center leading-none">D2<br>3/04</span></button>
            <button onclick="switchPage('page-day3')" id="nav-day3" class="nav-item"><i class="fas fa-person-walking-luggage text-xl mb-1"></i><span class="text-[10px] text-center leading-none">D3<br>3/05</span></button>
            <button onclick="switchPage('page-expenses')" id="nav-expenses" class="nav-item"><i class="fas fa-wallet text-xl mb-1"></i><span class="text-[10px] text-center leading-none">è¨˜å¸³<br>Â¥</span></button>
        </nav>

    </div>

    <script>
        function switchPage(pageId) {
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            const target = document.getElementById(pageId);
            if (target) { target.classList.add('active'); window.scrollTo(0,0); }
            
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            const navMap = { 'page-home': 'nav-home', 'page-day1': 'nav-day1', 'page-day2': 'nav-day2', 'page-day3': 'nav-day3', 'page-expenses': 'nav-expenses' };
            if (navMap[pageId]) document.getElementById(navMap[pageId]).classList.add('active');
        }

        // Currency
        const jpyInput = document.getElementById('input-jpy');
        const twdInput = document.getElementById('input-twd');
        const rateDisplay = document.getElementById('exchange-rate-display');
        let exchangeRate = 0.215; 

        async function fetchRate() {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/JPY');
                const data = await response.json();
                if(data?.rates?.TWD) {
                    exchangeRate = data.rates.TWD;
                    rateDisplay.textContent = `1 TWD â‰ˆ ${(1/exchangeRate).toFixed(2)} JPY`;
                    if(jpyInput.value) jpyInput.dispatchEvent(new Event('input'));
                    renderExpenses(); // Re-render to update total TWD
                }
            } catch (e) { console.log('Using default rate'); }
        }

        jpyInput.addEventListener('input', (e) => {
            const val = parseFloat(e.target.value);
            twdInput.value = !isNaN(val) ? (val * exchangeRate).toFixed(0) : '';
        });

        twdInput.addEventListener('input', (e) => {
            const val = parseFloat(e.target.value);
            jpyInput.value = !isNaN(val) ? (val / exchangeRate).toFixed(0) : '';
        });

        // ================= EXPENSE TRACKER LOGIC =================
        const categories = [
            { id: 'food', name: 'é£²é£Ÿ', icon: 'fa-utensils', color: 'bg-orange-50', chartColor: '#fdba74' },
            { id: 'shopping', name: 'è³¼ç‰©', icon: 'fa-shopping-bag', color: 'bg-pink-50', chartColor: '#f9a8d4' },
            { id: 'transport', name: 'äº¤é€š', icon: 'fa-train', color: 'bg-blue-50', chartColor: '#93c5fd' },
            { id: 'accommodation', name: 'ä½å®¿', icon: 'fa-bed', color: 'bg-purple-50', chartColor: '#d8b4fe' },
            { id: 'other', name: 'å…¶ä»–', icon: 'fa-ellipsis-h', color: 'bg-gray-100', chartColor: '#d1d5db' }
        ];

        let expensesData = JSON.parse(localStorage.getItem('nagoya_expenses')) || {
            food: [], shopping: [], transport: [], accommodation: [], other: []
        };

        function renderExpenses() {
            const container = document.getElementById('expenses-container');
            container.innerHTML = '';
            let totalJPY = 0;
            let categoryTotals = {};

            // 1. Render Categories
            categories.forEach(cat => {
                const section = document.createElement('div');
                section.className = `sketch-card p-4 ${cat.color}`;
                let catTotal = 0;
                
                // Header
                let html = `
                    <div class="flex items-center gap-2 mb-3 border-b-2 border-black pb-2">
                        <i class="fas ${cat.icon} text-xl"></i>
                        <h3 class="font-bold text-lg">${cat.name}</h3>
                    </div>
                    <div class="space-y-2 mb-3" id="list-${cat.id}">
                `;

                // List Items
                if (expensesData[cat.id]) {
                    expensesData[cat.id].forEach((item, index) => {
                        const price = parseInt(item.price) || 0;
                        catTotal += price;
                        totalJPY += price;
                        html += `
                            <div class="expense-row">
                                <span class="font-bold text-gray-700">${item.desc}</span>
                                <div class="flex items-center">
                                    <span class="font-black mr-2">Â¥${item.price}</span>
                                    <i class="fas fa-trash-alt delete-btn" onclick="deleteExpense('${cat.id}', ${index})"></i>
                                </div>
                            </div>
                        `;
                    });
                }
                categoryTotals[cat.id] = catTotal;

                html += `</div>`; // End List

                // Add Form
                html += `
                    <div class="flex gap-2 mt-2">
                        <input type="text" id="desc-${cat.id}" placeholder="å“é …" class="sketch-input w-2/3 p-2 text-sm bg-white">
                        <input type="number" id="price-${cat.id}" placeholder="Â¥" class="sketch-input w-1/3 p-2 text-sm bg-white font-bold">
                        <button onclick="addExpense('${cat.id}')" class="bg-black text-white rounded-lg px-3 hover:bg-gray-800 transition">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                `;

                section.innerHTML = html;
                container.appendChild(section);
            });

            // 2. Render Pie Chart (Append to container)
            if (totalJPY > 0) {
                let currentAngle = 0;
                let gradientString = '';
                let legendHtml = '';

                categories.forEach((cat, index) => {
                    const catTotal = categoryTotals[cat.id] || 0;
                    if (catTotal > 0) {
                        const percent = (catTotal / totalJPY) * 100;
                        const endAngle = currentAngle + percent;
                        
                        // Add to gradient
                        gradientString += `${cat.chartColor} ${currentAngle}% ${endAngle}%, `;
                        currentAngle = endAngle;

                        // Add to legend
                        legendHtml += `
                            <div class="flex items-center gap-1">
                                <div class="w-3 h-3 rounded-full" style="background-color: ${cat.chartColor}"></div>
                                <span>${cat.name} (${Math.round(percent)}%)</span>
                            </div>
                        `;
                    }
                });
                
                // Remove trailing comma
                gradientString = gradientString.slice(0, -2);

                const chartSection = document.createElement('div');
                chartSection.innerHTML = `
                    <div class="sketch-card p-4 mt-6 bg-white mb-24 relative overflow-hidden">
                        <h3 class="font-bold text-lg mb-4 text-center border-b-2 border-dashed border-gray-300 pb-2">
                            <i class="fas fa-chart-pie mr-2"></i>æ”¯å‡ºåˆ†ä½ˆ
                        </h3>
                        <div class="flex items-center justify-center py-2">
                            <div class="w-40 h-40 rounded-full border-2 border-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]" 
                                 style="background: conic-gradient(${gradientString})">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-2 mt-4 text-xs justify-items-center">
                            ${legendHtml}
                        </div>
                    </div>
                `;
                container.appendChild(chartSection);
            }

            // Update Totals
            document.getElementById('total-jpy').textContent = totalJPY.toLocaleString();
            document.getElementById('total-twd').textContent = Math.round(totalJPY * exchangeRate).toLocaleString();
        }

        function addExpense(catId) {
            const descInput = document.getElementById(`desc-${catId}`);
            const priceInput = document.getElementById(`price-${catId}`);
            const desc = descInput.value.trim();
            const price = parseInt(priceInput.value);

            if (desc && price) {
                if (!expensesData[catId]) expensesData[catId] = [];
                expensesData[catId].push({ desc, price });
                saveAndRender();
            }
        }

        function deleteExpense(catId, index) {
            if (confirm('ç¢ºå®šåˆªé™¤æ­¤ç­†ç´€éŒ„ï¼Ÿ')) {
                expensesData[catId].splice(index, 1);
                saveAndRender();
            }
        }

        function saveAndRender() {
            localStorage.setItem('nagoya_expenses', JSON.stringify(expensesData));
            renderExpenses();
        }

        // Initialize
        fetchRate();
        renderExpenses();
    </script>
</body>
</html>